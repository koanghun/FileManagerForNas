# 백엔드 주요 개념 설명

이 문서는 백엔드 개발, 특히 FastAPI 프레임워크에서 사용되는 핵심 개념인 CORS, `main.py`의 역할, 그리고 미들웨어(Middleware)에 대해 설명합니다.

## 1. CORS (Cross-Origin Resource Sharing, 교차 출처 리소스 공유)

### CORS란?
웹 브라우저의 중요한 보안 정책 중 하나인 **'동일 출처 정책(Same-Origin Policy)'** 때문에 필요한 개념입니다. 이 정책은 기본적으로 하나의 웹 페이지(하나의 '출처')가 다른 '출처'의 리소스를 요청하는 것을 제한합니다.

> **출처(Origin)란?**
> 프로토콜(예: `http`), 호스트(예: `localhost`), 그리고 포트 번호(예: `:3000`)를 모두 합친 것을 말합니다. 이 중 하나라도 다르면 다른 출처로 간주됩니다.

### 왜 필요한가?
우리 프로젝트의 프론트엔드(React)는 `http://localhost:3000`에서, 백엔드(FastAPI)는 `http://localhost:8000`에서 실행됩니다. 이 둘은 포트 번호가 다르기 때문에 서로 다른 출처입니다. 따라서 프론트엔드가 백엔드 API를 호출하면, 브라우저의 동일 출처 정책에 의해 기본적으로 차단됩니다.

### 해결 방법
백엔드 서버에서 특정 출처(예: 프론트엔드)를 신뢰한다고 명시하여, 해당 출처로부터 오는 요청을 허용하도록 설정해야 합니다. 이 허가 메커니즘이 바로 CORS입니다. 백엔드는 응답 헤더에 CORS 관련 정보를 담아 브라우저에 전달하고, 브라우저는 이 헤더를 확인하여 요청을 허용할지 결정합니다.

## 2. `backend/main.py` 파일의 역할

이 파일은 우리 프로젝트 **백엔드 서버의 주 진입점(Main Entrypoint)** 입니다.

- **FastAPI 애플리케이션 생성:** `app = FastAPI()` 코드를 통해 FastAPI 애플리케이션의 핵심 인스턴스인 `app` 객체를 생성합니다. 이 객체를 통해 서버의 모든 설정을 관리합니다.
- **API 엔드포인트 정의:** `@app.get("/")`와 같은 '데코레이터(Decorator)'를 사용하여 특정 URL 경로로 들어오는 요청을 처리할 함수를 지정합니다. 예를 들어, `@app.get("/api/test")`는 `/api/test` 경로로 `GET` 요청이 오면 바로 아래에 정의된 함수를 실행하라는 의미입니다.
- **서버 실행:** 터미널에서 `uvicorn backend.main:app --reload` 명령을 실행하면, Uvicorn 서버는 `backend/main.py` 파일 안에 있는 `app` 객체를 찾아 실행하여 웹 서버를 구동시킵니다.

## 3. `app.add_middleware(...)` 코드 설명

이 코드는 위에서 설명한 CORS 정책을 우리 FastAPI 애플리케이션에 적용하는 부분입니다.

### 미들웨어(Middleware)란?
미들웨어는 모든 요청이 실제 API 엔드포인트에 도달하기 전, 그리고 모든 응답이 클라이언트에게 전송되기 전에 거치는 **'중간 처리 계층'** 입니다. 모든 요청/응답에 공통적으로 적용할 기능(예: 로깅, 인증, CORS 처리 등)을 넣을 때 매우 유용합니다.

### `CORSMiddleware` 적용
`app.add_middleware(CORSMiddleware, ...)` 코드는 FastAPI에 내장된 `CORSMiddleware`를 우리의 `app`에 미들웨어로 추가하라는 명령어입니다. 이 미들웨어는 들어오는 모든 요청을 가로채 CORS 정책에 맞는지 확인하고, 나가는 모든 응답에 적절한 CORS 헤더를 추가해주는 역할을 합니다.

- **`allow_origins=origins`**: 어떤 출처의 요청을 허용할지 지정하는 가장 중요한 부분입니다. 우리는 `origins` 리스트에 프론트엔드 주소인 `"http://localhost:3000"`을 추가하여 해당 출처의 요청을 허용했습니다.
- **`allow_credentials=True`**: 자격 증명(쿠키, 인증 헤더 등)을 포함한 요청을 허용할지 여부를 결정합니다.
- **`allow_methods=["*"]`**: 허용할 HTTP 메서드를 지정합니다. `*`는 '전부'를 의미하는 와일드카드로, GET, POST, PUT, DELETE 등 모든 메서드를 허용합니다.
- **`allow_headers=["*"]`**: 요청에 허용할 HTTP 헤더를 지정합니다. 마찬가지로 `*`는 모든 헤더를 허용한다는 의미입니다.
